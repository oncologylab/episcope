% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_connect_tf_enhancers_to_target_genes.R
\name{correlate_atac_to_genes}
\alias{correlate_atac_to_genes}
\title{Correlate ATAC peaks to connected genes (generic enhancer/promoter sources) and filter by FDR.}
\usage{
correlate_atac_to_genes(
  grn_set,
  gh_tbl,
  gh_cols = list(chrom = "chrom", start = "start", end = "end", gene = "connected_gene",
    id = NULL, conf = NULL),
  gene_mode = c("both", "ensembl", "hgnc"),
  fdr = 0.05,
  keep_pos = FALSE,
  r_abs_min = 0.3,
  workers = max(1L, parallel::detectCores() - 1L)
)
}
\arguments{
\item{grn_set}{GRN set (from build_grn_set).}

\item{gh_tbl}{Tibble with *at least* columns: chrom, start, end, connected_gene (names configurable via gh_cols).}

\item{gh_cols}{Named list mapping column names: list(chrom="chrom", start="start", end="end", gene="connected_gene").
Optional extras (if present) are kept during overlap: id="gh_id", conf="confidence".}

\item{gene_mode}{"both", "ensembl", or "hgnc" â€” which gene identifiers to match to RNA.}

\item{fdr}{BH FDR cutoff.}

\item{keep_pos}{If TRUE, retain only positive correlations.}

\item{workers}{Parallel workers (future.apply). Use 1 for serial.}
}
\value{
list(atac_gene_corr_kept, atac_gene_corr_full)
}
\description{
Correlate ATAC peaks to connected genes (generic enhancer/promoter sources) and filter by FDR.
}
