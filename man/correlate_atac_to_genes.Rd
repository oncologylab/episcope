% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step2_connect_tf_genes.R
\name{correlate_atac_to_genes}
\alias{correlate_atac_to_genes}
\title{Correlate ATAC peaks to connected genes (generic enhancer/promoter sources) and filter by FDR.}
\usage{
correlate_atac_to_genes(
  grn_set,
  gh_tbl,
  gh_cols = list(chrom = "chrom", start = "start", end = "end", gene = "connected_gene",
    id = NULL, conf = NULL),
  gene_mode = c("both", "ensembl", "hgnc"),
  fdr = 0.05,
  keep_pos = FALSE,
  r_abs_min = 0.3,
  cor_method = c("pearson", "spearman"),
  workers = max(1L, parallel::detectCores() - 1L),
  cache_dir = NULL,
  cache_tag = NULL,
  cache_chunk_size = 5000L,
  cache_resume = TRUE,
  cache_verbose = FALSE
)
}
\arguments{
\item{grn_set}{GRN set (from build_grn_set).}

\item{gh_tbl}{Tibble with *at least* columns: chrom, start, end, connected_gene
(names configurable via gh_cols).}

\item{gh_cols}{Named list mapping column names:
list(chrom="chrom", start="start", end="end", gene="connected_gene").
Optional extras (if present) are kept during overlap: id="gh_id", conf="confidence".}

\item{gene_mode}{"both", "ensembl", or "hgnc" - which gene identifiers to match to RNA.}

\item{fdr}{BH FDR cutoff.}

\item{keep_pos}{If TRUE, retain only positive correlations.}

\item{r_abs_min}{Absolute correlation cutoff (applied to |r_atac|).}

\item{cor_method}{Correlation method passed to stats::cor: "pearson" or "spearman".}

\item{workers}{Parallel workers. Use 1 for serial.

Caching options (optional; default = no caching, original behaviour):}

\item{cache_dir}{Optional directory for on-disk caching. If NULL (default), no
caching is used and the function behaves as before.}

\item{cache_tag}{Character label to namespace caches within `cache_dir`. If NULL,
a tag is derived from `gene_mode` and `cor_method`.}

\item{cache_chunk_size}{Approximate number of (atac_peak, gene_key) pairs per
CSV chunk file when caching. More chunks -> more files, finer
granularity for resume; fewer chunks -> larger files.}

\item{cache_resume}{Logical; if TRUE (default), re-use any existing cached
correlations matching the requested (atac_peak, gene_key) pairs.
If FALSE, ignore old cache contents and overwrite with new results.}

\item{cache_verbose}{Logical; if TRUE, emit detailed messages about cache/index/chunks.}
}
\value{
list(atac_gene_corr_kept, atac_gene_corr_full)
}
\description{
Correlate ATAC peaks to connected genes (generic enhancer/promoter sources) and filter by FDR.
}
