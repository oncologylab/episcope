% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step3_grn_filter.R
\name{filter_links_deltas}
\alias{filter_links_deltas}
\title{Filter delta-links table by multi-criteria (expression, FP, link, delta)}
\usage{
filter_links_deltas(
  x,
  gene_expr_min = 4,
  tf_expr_min = 4,
  fp_min = 4,
  link_min = 2,
  abs_delta_min = 2,
  apply_de_gene = FALSE,
  apply_de_tf = FALSE,
  gene_log2fc_cutoff = NULL,
  tf_log2fc_cutoff = NULL,
  fp_cutoff = NULL,
  enforce_link_expr_sign = TRUE,
  tf_opposition_log2fc_cutoff = NULL,
  expr_dir_col = "log2FC_gene_expr",
  save_csv = FALSE,
  out_file = NULL,
  verbose = TRUE
)
}
\arguments{
\item{x}{Tibble/data.frame from \code{compare_links_two_conditions()}, or path to a CSV.}

\item{gene_expr_min}{numeric; default 4}

\item{tf_expr_min}{numeric; default 4}

\item{fp_min}{numeric; default 4}

\item{link_min}{numeric; default 2}

\item{abs_delta_min}{numeric; default 2}

\item{apply_de_gene}{logical; require |log2FC_gene_expr| ?gene_log2fc_cutoff}

\item{apply_de_tf}{logical; require |log2FC_tf_expr|   ?tf_log2fc_cutoff}

\item{gene_log2fc_cutoff}{numeric absolute log2FC threshold.}

\item{tf_log2fc_cutoff}{numeric absolute log2FC threshold.}

\item{fp_cutoff}{numeric absolute threshold for footprint score change
(column `delta_fp_score`).}

\item{enforce_link_expr_sign}{logical; if TRUE, drop rows whose delta_link_score
direction contradicts expected gene direction given link_sign_* (default TRUE).}

\item{tf_opposition_log2fc_cutoff}{numeric absolute log2FC threshold used to
define significant TF expression change for opposite-direction removal.}

\item{expr_dir_col}{character; gene-change column to use for direction; default "log2FC_gene_expr"}

\item{save_csv}{logical; write filtered CSV. Default FALSE}

\item{out_file}{optional character; output path. If NULL and `x` is a file,
writes alongside input as "*_filtered.csv".}

\item{verbose}{logical; default TRUE}
}
\value{
Tibble filtered to rows passing all criteria.
}
\description{
Filter *_delta_links.csv (or in-memory tables) using:
  1) any gene_expr_*    > gene_expr_min
  2) any tf_expr_*      > tf_expr_min
  3) any fp_score_* > fp_min
  4) any link_score_*   > link_min
  5) |delta_link_score| > abs_delta_min
  6) Optional absolute |log2FC| thresholds:
     - log2FC_gene_expr (via apply_de_gene + gene_log2fc_cutoff)
     - log2FC_tf_expr   (via apply_de_tf   + tf_log2fc_cutoff)
}
\details{
Columns are NOT renamed; output preserves original names. If a criterions
columns are missing, it is skipped with a warning.
}
\examples{
\dontrun{
# Single file
out <- episcope::filter_links_deltas(
  "path/to/HPAFII_0_FBS_vs_HPAFII_10_FBS_delta_links.csv",
  gene_expr_min = 4, tf_expr_min = 4, fp_min = 4, link_min = 2, abs_delta_min = 2,
  apply_de_gene = TRUE, gene_log2fc_cutoff = 0.585, save_csv = TRUE
)
}
}
