% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step2_grn_pipeline.R
\name{extract_link_info_by_condition}
\alias{extract_link_info_by_condition}
\title{Extract per-condition link tables from lighting output (or run wrapper)}
\usage{
extract_link_info_by_condition(
  out_dir = NULL,
  prefix = "",
  read_tables = FALSE,
  verbose = TRUE,
  omics_data = NULL,
  links = NULL,
  qc = FALSE,
  label_col = "strict_match_rna",
  link_score_threshold = 0,
  fp_score_threshold = 1,
  tf_expr_threshold = 10,
  fp_bound_tbl = NULL,
  rna_expressed_tbl = NULL,
  atac_score_tbl = NULL,
  atac_score_threshold = 0,
  require_atac_score = FALSE,
  fp_annotation_tbl = NULL,
  require_fp_bound = TRUE,
  require_gene_expr = TRUE,
  gene_expr_threshold = 1L,
  filter_active = FALSE,
  use_parallel = TRUE,
  workers = 2L,
  fp_variance_tbl = NULL,
  rna_variance_tbl = NULL,
  rna_tbl_for_basal = NULL,
  rna_method_for_basal = "pearson",
  rna_cores_for_basal = workers,
  tf_gene_cache_dir = NULL,
  tf_gene_cache_tag = NULL,
  tf_gene_cache_resume = TRUE,
  tf_gene_cache_verbose = TRUE,
  basal_cache_dir = NULL,
  basal_cache_tag = NULL,
  basal_cache_resume = NULL,
  basal_cache_verbose = NULL
)
}
\arguments{
\item{out_dir}{Directory containing per-condition link CSVs (reader mode), or
output directory to write to (wrapper mode). If omitted in wrapper mode,
inferred from `base_dir` in `.GlobalEnv`.}

\item{prefix}{Optional prefix used by [light_by_condition()] output files.
Default is empty string (no prefix).}

\item{read_tables}{If TRUE, read and return a combined table with
a `condition` column.}

\item{verbose}{Emit status messages.}

\item{omics_data}{Optional GRN object used in wrapper mode.}

\item{links}{Optional FP->gene link table for wrapper mode. Can be either a
data.frame (e.g., `fp_gene_corr_use`) or a list containing
`fp_gene_corr_kept`.}

\item{qc}{If TRUE, write a simple per-condition row-count CSV/PDF summary.}

\item{label_col}{Condition label column used by
[prepare_grn_set_for_light_by_condition()] and [light_by_condition()].}

\item{link_score_threshold}{Passed to [light_by_condition()].}

\item{fp_score_threshold}{Passed to [light_by_condition()].}

\item{tf_expr_threshold}{Passed to [light_by_condition()].}

\item{fp_bound_tbl}{Optional; defaults to `omics_data$fp_bound_condition`.}

\item{rna_expressed_tbl}{Optional; defaults to `omics_data$rna_expressed`.}

\item{atac_score_tbl}{Optional ATAC table for [light_by_condition()].}

\item{atac_score_threshold}{Passed to [light_by_condition()].}

\item{require_atac_score}{Passed to [light_by_condition()].}

\item{fp_annotation_tbl}{Optional; defaults to `omics_data$fp_annotation`.}

\item{require_fp_bound}{Passed to [light_by_condition()].}

\item{require_gene_expr}{Passed to [light_by_condition()].}

\item{gene_expr_threshold}{Passed to [light_by_condition()].}

\item{filter_active}{Passed to [light_by_condition()].}

\item{use_parallel}{Passed to [light_by_condition()].}

\item{workers}{Passed to [light_by_condition()].}

\item{fp_variance_tbl}{Optional; defaults to `omics_data$fp_variance`.}

\item{rna_variance_tbl}{Optional; defaults to `omics_data$rna_variance`.}

\item{rna_tbl_for_basal}{Optional RNA table passed to [make_basal_links()].
Defaults to `omics_data$rna_condition` if present, else `omics_data$rna`.}

\item{rna_method_for_basal}{Passed to [make_basal_links()].}

\item{rna_cores_for_basal}{Passed to [make_basal_links()].}

\item{tf_gene_cache_dir}{Optional cache directory for wrapper-mode TF-gene links.
Defaults to `file.path(out_dir, "cache", "tf_gene_corr")`.}

\item{tf_gene_cache_tag}{Optional cache tag for wrapper-mode TF-gene links.}

\item{tf_gene_cache_resume}{If TRUE, reuse cached TF-gene links when available.}

\item{tf_gene_cache_verbose}{Emit cache status messages for TF-gene links.}

\item{basal_cache_dir}{Deprecated alias for `tf_gene_cache_dir`.}

\item{basal_cache_tag}{Deprecated alias for `tf_gene_cache_tag`.}

\item{basal_cache_resume}{Deprecated alias for `tf_gene_cache_resume`.}

\item{basal_cache_verbose}{Deprecated alias for `tf_gene_cache_verbose`.}
}
\value{
In reader mode, returns a manifest tibble (or `list(manifest, links)`
  when `read_tables = TRUE`). In wrapper mode, returns the same outputs after
  writing per-condition link matrices.
}
\description{
This function supports two modes:
1. Reader mode (existing behavior): provide `out_dir` and it discovers and
   summarizes per-condition tables written by [light_by_condition()].
2. Wrapper mode (Module 2 quick-start): provide `omics_data` and `links`
   (or call positionally as `extract_link_info_by_condition(omics_data, links, ...)`).
   It will run:
   [make_basal_links()] -> [prepare_grn_set_for_light_by_condition()] ->
   [light_by_condition()] before extracting per-condition outputs.
}
