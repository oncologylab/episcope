% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step1_align_footprints.R
\name{align_footprints}
\alias{align_footprints}
\title{Align footprints by peak similarity}
\usage{
align_footprints(
  fp_filtered_manifest,
  mid_slop = 10L,
  round_digits = 1L,
  score_match_pct = 0.8,
  verbose = TRUE,
  threads = max(1L, parallel::detectCores(TRUE)),
  cache_dir = NULL,
  cache_tag = NULL,
  use_cache = TRUE,
  write_cache = TRUE,
  log_file = NULL,
  parallel_by = c("atac_peak", "chromosome", "none"),
  output_mode = c("full", "distinct")
)
}
\arguments{
\item{fp_filtered_manifest}{Tibble/data.frame with columns
\code{motif, score, bound, annot} and either \code{n_rows} or \code{n_peaks}.}

\item{mid_slop}{Integer; midpoint tolerance in bp for merging peaks.}

\item{round_digits}{Integer; number of digits for rounding scores before matching.}

\item{score_match_pct}{Numeric; fraction of score columns that must match.}

\item{verbose}{Logical; print progress.}

\item{threads}{Integer; data.table threads and parallel workers for fuzzy matching.}

\item{cache_dir}{Optional directory for cached outputs.}

\item{cache_tag}{Optional cache tag (used to build cache file names).}

\item{use_cache}{Logical; read cached outputs if available.}

\item{write_cache}{Logical; write cached outputs.}

\item{log_file}{Optional log file path for per-chromosome summaries.}

\item{parallel_by}{Parallelization scope. Use \code{"atac_peak"} to parallelize
within each chromosome (default), \code{"chromosome"} to parallelize across
chromosomes, or \code{"none"} for sequential execution.}

\item{output_mode}{Output structure. Use \code{"full"} (default) or
\code{"distinct"}; both return the 4-slot list with aligned, unique rows.
In \code{"distinct"}, \code{fp_score} has one row per aligned \code{peak_ID}
(no motif duplication) and \code{fp_bound} matches that row set.}
}
\value{
List with tibbles: \code{fp_score}, \code{fp_bound},
  \code{fp_annotation}, and \code{id_map}.
}
\description{
Aligns footprint peaks across motifs and samples by grouping peaks that match
on rounded score signatures within each ATAC peak and chromosome, then merges
nearby peaks by midpoint proximity.
}
\examples{
\dontrun{
fp_aligned <- align_footprints(fp_manifest, cache_dir = "cache", cache_tag = "JASPAR2024")
}
}
