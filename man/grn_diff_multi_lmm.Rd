% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_grn_diff_multi.R
\name{grn_diff_multi_lmm}
\alias{grn_diff_multi_lmm}
\title{Edge-wise mixed-effects modeling with lmer on TFâ€“gene links}
\usage{
grn_diff_multi_lmm(
  inputs,
  sample_info,
  formula,
  effect_terms,
  value_col = "link_score",
  strict = TRUE,
  dedupe = TRUE,
  dedupe_method = c("max_link_score", "first"),
  verbose = TRUE,
  ...
)
}
\arguments{
\item{inputs}{Character vector of CSVs or list of data.frames/tibbles.}

\item{sample_info}{Data.frame with one row per input, in the same order.
All variables referenced in `formula` must exist in `sample_info`.}

\item{formula}{Model formula for `lmer` **using response name `value`**,
e.g., `value ~ treatment + time + (1 | mouse_id)`.}

\item{effect_terms}{Character vector of row names in the fixed-effects
coefficient table to extract (e.g., `"treatmentLPS"`, `"time"`).}

\item{value_col}{Column in the link tables to model (default `"link_score"`).}

\item{strict, }{dedupe, dedupe_method Passed to `.load_multi_links_matrix()`.}

\item{verbose}{Logical.}

\item{...}{Additional arguments passed to `lme4::lmer()` / `lmerTest::lmer()`
(e.g., `REML = FALSE`).}
}
\value{
A tibble with:
  - `tf`, `gene_key`, `peak_id`.
  - For each `effect_terms[i]`, columns:
      - `beta_<term>`, `se_<term>`, `t_<term>`, `p_<term>`, `fdr_<term>`.
}
\description{
This function fits a linear mixed-effects model per edge using `lmer`,
allowing you to:
  - Model time/dose and other covariates as fixed effects.
  - Include per-sample/subject random effects (e.g., `(1 | mouse_id)`).
  - Extract one or more "biological" fixed effects (e.g. `treatmentLPS`
    for LPS vs Ctrl) with formal tests, while adjusting for time/dose.
}
\details{
**NOTE:** This is computationally heavier than the limma-based functions and
is best applied to a subset of edges (e.g., pre-filtered by limma).
}
