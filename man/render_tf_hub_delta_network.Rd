% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_grn_link_network_tf.R
\name{render_tf_hub_delta_network}
\alias{render_tf_hub_delta_network}
\title{TF-hub Δ subnetwork (single panel)}
\usage{
render_tf_hub_delta_network(
  comp_csv,
  input_tf,
  out_html = NULL,
  edge_filter_min = 2,
  edge_filter_on = c("either", "stress", "control", "both"),
  gene_fc_thresh = 1.5,
  de_reference = c("str_over_ctrl", "ctrl_over_str"),
  ring_tf_outgoing = "full",
  ring_tf_topk = 250,
  motif_db = c("hocomocov13", "jaspar2024"),
  ring_tf_only_direct = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{comp_csv}{Path to the comparison CSV (e.g., `*_delta_links_filtered_lda_K20.csv`).}

\item{input_tf}{Root TF symbol to visualize at the center.}

\item{out_html}{Optional output HTML path (default: alongside \code{comp_csv},
named `\{file\}_tfhub_delta_\{TF\}.html`).}

\item{edge_filter_min}{Numeric minimum absolute `link_score_*` required for an edge to be
considered (filtering uses score magnitude only; “active” flags still affect styling).}

\item{edge_filter_on}{One of \code{"either"}, \code{"stress"}, \code{"control"}, \code{"both"},
indicating on which side(s) the magnitude threshold must pass.}

\item{gene_fc_thresh}{Fold-change threshold used for up/down border coloring (default `1.5`).}

\item{de_reference}{One of \code{"str_over_ctrl"} (default) or \code{"ctrl_over_str"}; controls
the sign convention for TF box fill and gene border log2FC.}

\item{ring_tf_outgoing}{\code{"context"} (legacy default), \code{"full"}, or \code{"full_topk"}.
Controls how **ring TFs** (non-root TFs) contribute outgoing edges:
\itemize{
  \item \strong{context}: only show edges needed to explain co-regulated genes with the root TF,
        plus TF↔TF context.
  \item \strong{full}: include all outgoing edges from ring TFs within the TF set.
  \item \strong{full_topk}: like \emph{full} but per-TF keep only the top-K strongest edges.
}}

\item{ring_tf_topk}{Integer; only used if \code{ring_tf_outgoing="full_topk"} (default `250`).}

\item{motif_db}{Character; \code{"hocomocov13"} (default) or \code{"jaspar2024"}—used to establish
the TF symbol universe for TF vs. gene typing.}

\item{verbose}{Logical; print progress messages.}

\item{ring_tf_direct_only}{Logical; if \code{TRUE}, the ring of TFs includes \emph{only} TFs that are
directly connected to the root TF (either the root regulates them or they regulate the root).
No additional TFs are pulled in merely because they co-regulate the same gene(s). When
\code{FALSE} (default), behavior matches the current implementation (direct TFs plus those
second-order TFs brought in by co-regulation context).}
}
\value{
(Invisibly) the path to the written HTML file.
}
\description{
Build and save an interactive, TF-centric **delta-links** network from a single
“comparison filtered clustered” CSV where per-condition measures already live side-by-side
(columns like `*_ctrl` and `*_str`). The visualization encodes **Δ = stress − control**
on edges and preserves your legacy styling and HTML structure (node shapes, colors,
widths, legends, and jump menus).
}
\details{
Conceptually, the plot places the **root TF** at the center, arranges a ring of TFs around it,
and shows how regulatory links fan out to target genes through shared or unique enhancer
“peak” pseudonodes. TF box fill reflects signed TF RNA log2FC, gene dot size reflects the
maximum absolute Z-score of expression across sides, and edge hue/width convey the sign and
magnitude of Δ link strength. Dashed gray segments correspond to TF→peak, thin gray bridges
connect peak→gene, and direct TF→gene Δ edges are drawn faintly when also covered by peaks.


Expected columns (some are auto-detected with flexible tags): \cr
\code{TF}, \code{gene_key}, \code{peak_id}, \code{link_score_ctrl}, \code{link_score_str},
\code{link_sign_ctrl}, \code{link_sign_str}, optional activity flags
(\code{active_ctrl}, \code{active_str}), TF expression
(\code{tf_expr_ctrl}, \code{tf_expr_str}), and gene expression
(\code{gene_expr_ctrl}, \code{gene_expr_str}). Column names are resolved using the inferred
control/stress tags from the filename header (e.g., `A_vs_B`) with several common aliases.
}
\section{Visual encodings}{

\itemize{
  \item \strong{TF nodes}: box fill = signed TF RNA log2FC (blue→white→red);
        label font size ∝ max(TF RNA).
  \item \strong{Gene nodes}: dot size ∝ max absolute Z(expr) across sides; border color reflects
        up/down per \code{gene_fc_thresh} under \code{de_reference}.
  \item \strong{Edges}: color = red (Δ>0) or blue (Δ<0); width = fixed bins by |Δ|;
        TF→peak dashed gray; peak→gene neutral gray bridges; direct TF→gene Δ drawn faint.
}
}

\examples{
\dontrun{
render_tf_hub_delta_network(
  comp_csv  = system.file(
    "extdata/lighting_strict_hocomocov13_regulated_genes_1.5_delta_link_1",
    "AsPC1_Glc_vs_AsPC1_Ctrl_delta_links_filtered_lda_K20.csv",
    package = "episcope"
  ),
  input_tf  = "HSF2",
  edge_filter_min = 1,
  edge_filter_on  = "either",
  gene_fc_thresh  = 1.5,
  de_reference    = "str_over_ctrl",
  ring_tf_direct_only = TRUE,   # only direct TFs form the ring
  motif_db        = "hocomocov13",
  verbose         = TRUE
)
}
}
\seealso{
\code{render_link_network_delta_topic()}, \code{render_link_network_for_topic()}
}
\author{
Yaoxiang Li and Chunling Yi
}
