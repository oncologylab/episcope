% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step1_grn_preprocess.R
\name{tf_corr_footprints_all_tfbs}
\alias{tf_corr_footprints_all_tfbs}
\title{Correlate one TF with ALL footprints and export per-TF BEDs}
\usage{
tf_corr_footprints_all_tfbs(
  fp_manifest,
  tf_name,
  tf_expr,
  out_dir,
  cor_method = "pearson",
  min_non_na = 5L,
  r_thr = 0.3,
  fdr_thr = 0.05,
  threads = max(1L, parallel::detectCores(TRUE)),
  verbose = TRUE
)
}
\arguments{
\item{fp_manifest}{data.frame with columns motif,n_rows,score,bound,annot.}

\item{tf_name}{Character scalar; label written to outputs (e.g., "HNF4A").}

\item{tf_expr}{Named numeric vector (preferred) of TF expression with names
matching the footprint score column names. Alternatively, a
one-row numeric data.frame with column names as sample IDs.}

\item{out_dir}{Output directory to write files.}

\item{cor_method}{"pearson" (default) or "spearman".}

\item{min_non_na}{Minimum paired non-NA values required to test (default 5).}

\item{r_thr}{Correlation threshold for "bound" (default 0.30).}

\item{fdr_thr}{BH-FDR threshold for "bound" (default 0.05).}

\item{threads}{Integer threads for data.table fread (default: detectCores()).}

\item{verbose}{Logical; progress messages (default TRUE).}
}
\value{
(Invisibly) a list with:
\describe{
  \item{annot}{Tibble of TFBS annotations with r, p, p_adj.}
  \item{files}{Named character vector of written file paths.}
}
}
\description{
Minimal, fast path to:
1) load a single TF expression vector,
2) load *all* footprint score/annotation files from a manifest,
3) compute row-wise correlations (per TFBS) vs TF expression,
4) BH-adjust p-values,
5) write 3 BED files (`*_all.bed`, `*_bound.bed`, `*_unbound.bed`) and one
   tab-delimited overview (`*_overview.txt`) for the TF.
}
\details{
Assumptions:
- `fp_manifest` has columns `motif, n_rows, score, bound, annot`.
- Each `score` CSV has a `peak_ID` (or `fp_peak`) column and per-sample columns.
- Each `annot` CSV has `fp_peak` (or `peak_ID`), `atac_peak` (or `peak_ATAC`),
  and `motifs` (or `TFBS_name`) columns linking TFBSΓåÆATAC peak and name.
}
\examples{
\dontrun{
tf_vec <- c(S1=10, S2=8, S3=12)  # names must match columns in score CSVs
res <- tf_corr_footprints_all_tfbs(
  fp_manifest = fp_aligned_normalized_filtered_manifest,
  tf_name  = "HNF4A",
  tf_expr  = tf_vec,
  out_dir  = file.path(tempdir(), "hnf4a_out")
)
res$files
}
}
