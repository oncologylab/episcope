% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step3_grn_filter.R
\name{filter_links_deltas_bulk}
\alias{filter_links_deltas_bulk}
\title{Bulk/parallel filter over many delta-link CSVs}
\usage{
filter_links_deltas_bulk(
  delta_csvs,
  gene_expr_min = 4,
  tf_expr_min = 4,
  fp_min = 4,
  link_min = 2,
  abs_delta_min = 2,
  apply_de_gene = FALSE,
  apply_de_tf = FALSE,
  de_gene_log2_abs_min = NULL,
  de_tf_log2_abs_min = NULL,
  de_gene_fc_min = NULL,
  de_tf_fc_min = NULL,
  fp_delta_min = NULL,
  split_direction = FALSE,
  write_combined = TRUE,
  enforce_link_expr_sign = FALSE,
  expr_dir_col = "log2FC_gene_expr",
  parallel = TRUE,
  plan = "multisession",
  workers = NULL,
  save_csv = TRUE,
  write_manifest = TRUE,
  manifest_file = NULL,
  filtered_dir = NULL,
  verbose = TRUE
)
}
\arguments{
\item{delta_csvs}{Character vector of paths to *_delta_links.csv files
(e.g., \code{specs$out_file} from \code{build_cellwise_contrasts_from_index()}).}

\item{gene_expr_min}{numeric; default 4}

\item{tf_expr_min}{numeric; default 4}

\item{fp_min}{numeric; default 4}

\item{link_min}{numeric; default 2}

\item{abs_delta_min}{numeric; default 2}

\item{apply_de_gene}{logical; require |log2FC_gene_expr| ?de_gene_log2_abs_min}

\item{apply_de_tf}{logical; require |log2FC_tf_expr|   ?de_tf_log2_abs_min}

\item{de_gene_log2_abs_min}{numeric absolute log2FC threshold.}

\item{de_tf_log2_abs_min}{numeric absolute log2FC threshold.}

\item{de_gene_fc_min}{numeric absolute fold-change threshold (non-log2) for genes.}

\item{de_tf_fc_min}{numeric absolute fold-change threshold (non-log2) for TFs.}

\item{fp_delta_min}{numeric absolute delta threshold for footprint scores
(column `delta_fp_bed_score`).}

\item{split_direction}{Logical; write up/down filtered links per delta file.}

\item{write_combined}{Logical; write combined filtered CSV (default TRUE).}

\item{enforce_link_expr_sign}{logical; if TRUE, drop rows whose delta_link_score
direction contradicts expected gene direction given link_sign_* (default TRUE).}

\item{expr_dir_col}{character; gene-change column to use for direction; default "log2FC_gene_expr"}

\item{parallel}{Logical; run in parallel via \pkg{future.apply}. Default TRUE.}

\item{plan}{Future plan; string (e.g. "multisession") or function. Default "multisession".}

\item{workers}{Integer; default: availableCores()-1.}

\item{save_csv}{Logical; write *_filtered.csv next to each input (default TRUE).}

\item{write_manifest}{Logical; write a manifest CSV mapping source->filtered (default TRUE).}

\item{manifest_file}{Optional path for manifest; if NULL, written to the common dir as
"delta_links_filtered_manifest.csv".}

\item{verbose}{logical; default TRUE}
}
\value{
A list with fields: results (list of tibbles), filtered_paths, filtered_dirs, manifest (tibble), manifest_path.
}
\description{
Applies \code{filter_links_deltas()} across many \code{*_delta_links.csv} files,
optionally in parallel, and writes a manifest mapping source -> filtered outputs.
}
\examples{
\dontrun{
delta_csvs <- list.files("inst/extdata/lighting", "_delta_links.csv", full.names = TRUE)
de_gene_log2_abs_min <- 0.585
bulk <- episcope::filter_links_deltas_bulk(
  delta_csvs,
  gene_expr_min = 4, tf_expr_min = 4, fp_min = 4, link_min = 2, abs_delta_min = 2,
  apply_de_gene = TRUE,
  de_gene_log2_abs_min = de_gene_log2_abs_min,
  enforce_link_expr_sign = TRUE,
  expr_dir_col = "log2FC_gene_expr",
  workers = 20
)
bulk$filtered_paths
bulk$manifest_path
}
}
