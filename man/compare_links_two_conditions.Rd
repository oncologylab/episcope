% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step3_grn_diff.R
\name{compare_links_two_conditions}
\alias{compare_links_two_conditions}
\title{Compare two conditions (cond1 - cond2) for TF-gene links}
\usage{
compare_links_two_conditions(
  cond1,
  cond2,
  cond1_name = NULL,
  cond2_name = NULL,
  clean_names = FALSE,
  strict = TRUE,
  dedupe = TRUE,
  dedupe_method = c("max_link_score", "first"),
  sign_policy = c("error", "prefer_cond1", "prefer_max_magnitude", "drop"),
  pseudocount = 1,
  restrict_to_active_both = TRUE,
  edge_change_min = 0,
  keep_all_cols = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{cond1, cond2}{A tibble/data.frame or CSV path.}

\item{cond1_name, cond2_name}{Optional condition names; default derived from inputs.}

\item{clean_names}{Logical; if TRUE, sanitize condition names via `janitor::make_clean_names()`.}

\item{strict}{Logical; if TRUE, enforce identical key sets.}

\item{dedupe}{Logical; if TRUE, collapse duplicate keys per condition.}

\item{dedupe_method}{One of `c("max_link_score","first")`.}

\item{sign_policy}{One of `c("error","prefer_cond1","prefer_max_magnitude","drop")`.}

\item{pseudocount}{Non-negative numeric added for log2FC calculations (default 1).}

\item{restrict_to_active_both}{Logical; if TRUE, set delta/log2FC columns to NA
unless a link is active in both conditions (default TRUE).}

\item{edge_change_min}{Numeric; minimum |delta_link_score| used to classify
edges as gain/loss/shared (default 0).}

\item{keep_all_cols}{Logical; if TRUE, retain extra columns from per-condition
inputs and carry them through (default TRUE).}

\item{verbose}{Logical.}
}
\value{
A tibble with IDs, per-condition values, deltas, and log2FC columns.
}
\description{
Computes deltas for `link_score`, `fp_score`, `tf_expr`, `gene_expr`,
plus log2FC for expressions with a pseudocount. Enforces identical key sets
(`tf,gene_key,peak_id`) when `strict = TRUE` and reconciles `link_sign`
according to a chosen policy.
}
