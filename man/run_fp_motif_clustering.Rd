% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step1_motif_clustering.R
\name{run_fp_motif_clustering}
\alias{run_fp_motif_clustering}
\title{Run footprint-driven motif clustering with quality control (QC) plots}
\usage{
run_fp_motif_clustering(
  fp_aligned,
  out_dir = NULL,
  base_dir = NULL,
  mode = c("both", "data", "hybrid"),
  ref_similarity = NULL,
  ref_db = NULL,
  cache_dir = NULL,
  alpha = 0.5,
  min_peak_support = 100,
  sim_method = c("jaccard", "cosine"),
  linkage = "average",
  target_clusters = NULL,
  k_grid = NULL,
  run_mode = c("full", "pre"),
  qc_mode = c("fast", "full"),
  motif_db = NULL,
  cluster_source = c("hybrid", "data"),
  cores = NULL,
  weight_by_group_size = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{fp_aligned}{Output from align_footprints().}

\item{out_dir}{Output directory to save results and plots.}

\item{base_dir}{Optional base directory used to build a default out_dir.}

\item{mode}{Character; "data", "hybrid", or "both".}

\item{ref_similarity}{Optional reference similarity matrix (e.g., PPM Ncor).}

\item{ref_db}{Optional database name to compute reference similarity when ref_similarity is NULL.}

\item{cache_dir}{Optional cache directory (default: out_dir/cache).}

\item{alpha}{Numeric in [0,1]; hybrid similarity weight for ref_similarity.}

\item{min_peak_support}{Numeric; minimum weighted peak support per motif.}

\item{sim_method}{Character; "jaccard" or "cosine".}

\item{linkage}{Linkage method for hclust().}

\item{target_clusters}{Target number of clusters for cutree.}

\item{run_mode}{Character; "full" runs full clustering, "pre" runs minimal K selection only.}

\item{qc_mode}{Character; "fast" skips slow QC plots (default "fast").}

\item{motif_db}{Optional motif table (must include motif + gene_symbol); if provided,
adds sub_cluster and sub_cluster_name columns from clustering.}

\item{cluster_source}{Character; "hybrid" or "data" (default "hybrid").}

\item{cores}{Integer number of workers (default 1L).}

\item{weight_by_group_size}{Logical; weight by id_map$group_size if present.}

\item{verbose}{Logical; emit concise progress messages.}
}
\value{
List with similarity matrices and cluster tables.
}
\description{
Run footprint-driven motif clustering with quality control (QC) plots
}
