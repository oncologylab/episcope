% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step1_grn_preprocess.R
\name{correlate_tf_to_fp}
\alias{correlate_tf_to_fp}
\title{Correlate TF expression to footprint scores (Pearson + Spearman)}
\usage{
correlate_tf_to_fp(
  omics_data = NULL,
  grn_set = NULL,
  mode = c("canonical", "all"),
  label_col,
  out_dir,
  db,
  r_thr = 0.3,
  p_thr = 0.05,
  tf_subset = NULL,
  cores_pearson = 20L,
  cores_spearman = 36L,
  chunk_size = 5000L,
  min_non_na = 5L,
  qc = TRUE,
  write_bed = FALSE,
  write_outputs = TRUE,
  use_cache = TRUE,
  cache_dir = NULL,
  verbose = TRUE
)
}
\arguments{
\item{omics_data}{A multi-omic data list from [build_grn_set()].}

\item{grn_set}{(Deprecated) Use `omics_data`.}

\item{mode}{Correlation mode: "canonical" or "all".}

\item{label_col}{Metadata label column used for conditions.}

\item{out_dir}{Output directory for QC and overviews.}

\item{db}{Database tag used in output filenames.}

\item{r_thr}{Correlation threshold.}

\item{p_thr}{Adjusted P-value threshold.}

\item{tf_subset}{Optional TF subset.}

\item{cores_pearson}{Cores for Pearson correlation.}

\item{cores_spearman}{Cores for Spearman correlation.}

\item{chunk_size}{Chunk size for correlation.}

\item{min_non_na}{Minimum non-NA values.}

\item{qc}{If TRUE, generate QC PDF and overview tables.}

\item{write_bed}{If TRUE, emit per-TF BEDs (off by default).}

\item{use_cache}{If TRUE, reuse cached correlation tables.}

\item{cache_dir}{Optional cache directory (defaults under out_dir).}

\item{verbose}{Emit status messages.}
}
\value{
Updated grn_set with Pearson + Spearman annotations.
}
\description{
Runs Pearson and Spearman correlations, applies filters, and optionally
generates QC outputs and per-TF overview tables. Designed as a simple
user-facing wrapper for Module 1.
}
