% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step1_grn_preprocess.R
\name{combine_filtered_fp_tables_split_dimers_simple}
\alias{combine_filtered_fp_tables_split_dimers_simple}
\title{Combine FP correlation tables (split dimers), run BH FDR once across all,
sanity-check p vs p_adj, filter, and align score/bound to the kept annotations.}
\usage{
combine_filtered_fp_tables_split_dimers_simple(
  fp_filtered_manifest,
  p_thr = 0.05,
  r_thr = 0.3,
  verbose = TRUE,
  threads = max(1L, parallel::detectCores(TRUE)),
  output_bed = NULL
)
}
\arguments{
\item{fp_filtered_manifest}{Tibble/data.frame with columns:
`motif, n_rows, score, bound, annot` (CSV paths).}

\item{p_thr}{Numeric FDR threshold (default 0.05).}

\item{r_thr}{Numeric correlation threshold (keep r > r_thr; default 0.3).}

\item{verbose}{Logical; print progress (default TRUE).}

\item{threads}{Integer; data.table threads (default = all detected cores).}

\item{output_bed}{Optional directory path. If provided, the function will write per-TF
BED-like files: `<TF>_all.bed`, `<TF>_bound.bed`, `<TF>_unbound.bed` (no headers),
and `<TF>_overview.txt` (headered; same columns as `_all.bed` plus a `_bound` 0/1 column).
Columns: TFBS_chr, TFBS_start, TFBS_end, TFBS_name, peak_chr, peak_start, peak_end,
TF, corr_fp_tf_r, corr_fp_tf_p, corr_fp_tf_p_adj; bound/unbound defined by r/p filters.}
}
\value{
A list of tibbles: `fp_score`, `fp_bound`, `fp_annotation`
        (all aligned to the same row order).
}
\description{
Robust, minimal pipeline:
1) Normalizes columns when reading each file.
2) Splits comma-separated TF/r/p columns row-wise (handles dimers) with safe padding.
3) Runs **one** BenjaminiΓÇôHochberg adjustment across the combined annotations.
4) Enforces `p_adj >= p` and reports monotonicity stats.
5) Filters by `r_thr` (positive) and `p_thr` (FDR).
6) Reads score/bound only for peaks that pass, de-dups on `peak_ID`, and aligns order.
}
\examples{
# res <- combine_filtered_fp_tables_split_dimers_simple(fp_corr_manifest)
}
