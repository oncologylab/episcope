% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step3_topic_warplda.R
\name{train_topic_models}
\alias{train_topic_models}
\title{Train joint RNA+footprint topic models (Module 3)}
\usage{
train_topic_models(
  Kgrid,
  input_dir,
  output_dir,
  celllines = c("AsPC1", "HPAFII", "Panc1"),
  tf_cluster_map,
  doc_mode = c("tf_cluster", "tf"),
  tf_exclude = NULL,
  abs_log2fc_fp_min = 0,
  abs_delta_fp_min = 1,
  abs_log2fc_gene_min = 1,
  require_fp_bound_either = TRUE,
  require_tf_expr_either = TRUE,
  require_gene_expr_either = TRUE,
  direction_consistency = "aligned",
  top_terms_per_doc = Inf,
  min_df = 2,
  count_method = "bin",
  count_scale = 50,
  gene_term_mode = c("aggregate", "unique"),
  include_tf_terms = FALSE,
  count_input = c("pseudo_count_bin", "pseudo_count_log", "weight"),
  vae_variant = "multivi_encoder",
  backend = c("vae", "warplda"),
  reuse_if_exists = TRUE,
  binarize_method = "gammafit",
  thrP = 0.9,
  top_n_terms = 500L,
  in_topic_min_terms = 1,
  topic_report_args = list()
)
}
\arguments{
\item{Kgrid}{Integer vector of K values for training.}

\item{input_dir}{Directory containing differential links (filtered up/down).}

\item{output_dir}{Directory to write topic model outputs.}

\item{celllines}{Character vector of cell line prefixes.}

\item{tf_cluster_map}{Named vector mapping TFs to motif clusters.}

\item{tf_exclude}{Optional TFs to exclude.}

\item{abs_log2fc_fp_min}{Minimum |log2FC| footprint change for QC filtering.}

\item{abs_delta_fp_min}{Minimum |delta_fp| for QC filtering.}

\item{abs_log2fc_gene_min}{Minimum |log2FC| gene expression change for QC filtering.}

\item{require_fp_bound_either}{Require fp_bound in either condition.}

\item{require_tf_expr_either}{Require TF expression in either condition.}

\item{require_gene_expr_either}{Require gene expression in either condition.}

\item{direction_consistency}{Direction consistency mode for edge filtering.}

\item{top_terms_per_doc}{Max terms per document.}

\item{min_df}{Minimum document frequency for terms.}

\item{count_method}{Count method ("bin" or "log").}

\item{count_scale}{Count scaling factor.}

\item{binarize_method}{Topic binarization method.}

\item{thrP}{Topic term probability threshold.}

\item{top_n_terms}{Number of terms per topic.}

\item{in_topic_min_terms}{Minimum terms per topic set.}

\item{topic_report_args}{Additional args for downstream extraction (saved in calc_params).}
}
\description{
Builds documents from differential links and trains VAE topic models across
a user-supplied K grid. Writes model outputs (vae_models, rds, model_metrics.csv,
model_selection.pdf) without running downstream topic extraction.
}
