% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step1_grn_preprocess.R
\name{grn_add_rna_expressed}
\alias{grn_add_rna_expressed}
\alias{grn_add_rna_condition}
\alias{grn_add_fp_score_condition}
\alias{grn_add_atac_score_condition}
\alias{grn_add_fp_bound_condition}
\alias{grn_filter_fp_bound_condition}
\alias{grn_add_fp_score_qn}
\alias{grn_add_fp_tfs}
\alias{grn_add_fp_tf_corr}
\alias{grn_filter_fp_tf_corr}
\alias{write_grn_tf_corr_outputs}
\alias{write_grn_outputs}
\title{GRN set helpers for condition summaries and outputs}
\usage{
grn_add_rna_expressed(
  grn_set,
  label_col,
  threshold_gene_expr = 10,
  min_samples = 1L,
  force = FALSE,
  verbose = TRUE
)

grn_add_rna_condition(
  grn_set,
  label_col,
  agg_fun = c("mean", "median"),
  force = FALSE,
  verbose = TRUE
)

grn_add_fp_score_condition(
  grn_set,
  label_col,
  agg_fun = c("mean", "median"),
  force = FALSE,
  verbose = TRUE
)

grn_add_atac_score_condition(
  grn_set,
  label_col,
  agg_fun = c("mean", "median"),
  force = FALSE,
  verbose = TRUE
)

grn_add_fp_bound_condition(
  grn_set,
  label_col,
  threshold_fp_score = 2,
  min_samples = 1L,
  force = FALSE,
  verbose = TRUE
)

grn_filter_fp_bound_condition(
  grn_set,
  min_bound = 1L,
  use_parallel = TRUE,
  force = FALSE,
  verbose = FALSE
)

grn_add_fp_score_qn(grn_set, id_col = "peak_ID", force = FALSE, verbose = TRUE)

grn_add_fp_tfs(grn_set, force = FALSE, verbose = TRUE)

grn_add_fp_tf_corr(
  grn_set,
  method = c("pearson", "spearman", "kendall"),
  cores = 10L,
  chunk_size = 5000L,
  min_non_na = 5L,
  force = FALSE,
  verbose = TRUE
)

grn_filter_fp_tf_corr(
  grn_set,
  method = c("pearson", "spearman", "kendall"),
  r_thr = 0.3,
  p_thr = 0.05,
  set_active = TRUE,
  output_bed = NULL,
  output_bed_condition = NULL,
  label_col = NULL,
  verbose = TRUE
)

write_grn_tf_corr_outputs(grn_set, out_dir, db)

write_grn_outputs(grn_set, out_dir, db, qn_base_dir = NULL)
}
\arguments{
\item{grn_set}{A list returned by \code{build_grn_set()}.}

\item{label_col}{Metadata column used for per-condition outputs.}

\item{threshold_gene_expr}{Expression threshold for gene activity.}

\item{min_samples}{Minimum samples meeting a threshold.}

\item{force}{Recompute even if already present.}

\item{verbose}{Emit progress messages.}

\item{agg_fun}{Aggregation function for condition summaries.}

\item{threshold_fp_score}{Footprint score threshold for bound status.}

\item{min_bound}{Minimum number of bound samples per peak to keep.}

\item{use_parallel}{Use parallel computation when available.}

\item{id_col}{Identifier column for quantile normalization.}

\item{method}{Correlation method.}

\item{cores}{Number of CPU cores to use.}

\item{chunk_size}{Row chunk size for parallel processing.}

\item{min_non_na}{Minimum non-missing values required for correlations.}

\item{r_thr}{Correlation threshold.}

\item{p_thr}{Adjusted P-value threshold.}

\item{set_active}{Whether to set active flags after filtering.}

\item{output_bed}{Optional BED output path.}

\item{output_bed_condition}{Optional per-condition BED output path.}

\item{out_dir}{Output directory for writing artifacts.}

\item{db}{Motif database label.}

\item{qn_base_dir}{Base directory for quantile-normalized outputs.}
}
\value{
Updated \code{grn_set} or \code{invisible(TRUE)} for writer helpers.
}
\description{
These helpers add condition-level summaries (RNA and footprint),
compute filtered TF-annotation correlations, and write out
standard GRN outputs.
}
