% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_step2_connect_tf_genes.R
\name{episcope_make_windowed_gh}
\alias{episcope_make_windowed_gh}
\title{Build GH-like peak->gene links by distance window (no GeneHancer needed)}
\usage{
episcope_make_windowed_gh(
  peaks,
  genes,
  flank_bp = 30000L,
  mode = c("TSS", "full"),
  gene_annot = NULL,
  id_col = NULL
)
}
\arguments{
\item{peaks}{Tibble with either \code{peak_ID} or \code{atac_peak}
(both formatted \code{chr:start-end}) or explicit genomic columns
\code{chrom,start,end}.}

\item{genes}{EITHER:
\itemize{
  \item a tibble with \code{chrom}, \code{gene_key}, and either \code{tss}
        or \code{start,end,strand}; or
  \item a character vector of gene IDs (HGNC symbols or Ensembl IDs) to be
        looked up in \code{gene_annot}.
}}

\item{flank_bp}{Integer. Window size in bp to extend each peak on both sides
(default \code{20000}).}

\item{mode}{Character. \code{"TSS"} (default) uses transcription start site;
\code{"full"} uses full gene span.}

\item{gene_annot}{Optional tibble used only when \code{genes} is a character
vector. Must contain \code{chrom,start,end,strand} and an ID column
(e.g., \code{HGNC} or \code{ensembl_gene_id}) matching \code{genes}.}

\item{id_col}{Optional string naming the ID column in \code{gene_annot}.
If \code{NULL}, tries \code{"HGNC"}, \code{"gene_name"},
\code{"ensembl_gene_id"}, then \code{"gene_id"}.}
}
\value{
Tibble with GH-like columns ready for \code{build_gh_pairs_from_peaks()}:
  \code{chrom,start,end,connected_gene,gh_id,confidence,source,feature_name,
  strand,frame,is_elite_elem}.
}
\description{
Create GeneHancer-style rows by linking peaks to nearby genes within a
+/-\code{flank_bp} window. Works with either a ready-made gene table or a
character vector of gene IDs (HGNC or Ensembl) that are looked up in a
provided annotation table.
}
\examples{
# Using a genes tibble that already has TSS:
# genes_tbl <- tibble::tibble(chrom="chr1", tss=1e6, gene_key="TP53")
# gh_std <- episcope_make_windowed_gh(strict_set$atac_mt, genes_tbl, flank_bp=2e5, mode="TSS")

# Using a vector of IDs + annotation look-up:
# gene_annot_ref must have: chrom,start,end,strand, and an ID col (e.g. HGNC)
# gh_std <- episcope_make_windowed_gh(
#   peaks = strict_set$atac_score,   # now supports `atac_peak`
#   genes = c("SOX9","HNF1B","ENSG00000141510"),
#   flank_bp = 2e5, mode = "TSS",
#   gene_annot = gene_annot_ref, id_col = "HGNC"
# )

}
